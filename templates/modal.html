{{ define "modal" }}
<div
  id="modal"
  class="fixed z-50 left-1/4 top-16 w-1/2 h-5/6 overflow-auto self-center bg-red-50 rounded border-black border-2 m-2"
>
  <div class="grid grid-rows-auto grid-cols-1 h-auto">
    <div
      class="flex relative justify-center content-between row-start-1 row-end-2"
    >
      {{if eq .type "hex"}}
      <button
        type="submit"
        class="bg-blue-500 p-1 m-2 rounded size-fit text-xs"
        hx-post="/show-phys-page"
        hx-vals='{"type": "string"}'
        hx-target="#modal"
        hx-swap="outerHTML"
      >
        String
      </button>
      {{if eq .nx "false"}}
      <button
        type="submit"
        class="bg-blue-500 p-1 m-2 rounded size-fit text-xs"
        hx-post="/show-phys-page"
        hx-vals='{"type": "code"}'
        hx-target="#modal"
        hx-swap="outerHTML"
      >
        Code
      </button>
      {{end}}
      <form action="/download-phys-page" method="get" hx-disable="true">
        <button
          class="bg-blue-500 p-1 m-2 rounded size-fit text-xs"
          type="submit"
        >
          Download
        </button>
      </form>
      <form
        method="post"
        enctype="multipart/form-data"
        hx-post="/upload-phys-page"
        hx-swap="none"
      >
        <input
          class="bg-blue-500 p-1 m-2 rounded size-fit text-xs"
          type="file"
          name="file"
          required
        />
        <button
          id="uploadPage"
          class="bg-blue-500 p-1 m-2 rounded size-fit text-xs"
        >
          Upload
        </button>
      </form>
      <button
        type="submit"
        class="w-1/5 bg-blue-500 p-1 m-2 rounded size-fit text-xs"
        hx-post="/show-phys-page"
        hx-vals='{"type": "edit"}'
        hx-target="#modal"
        hx-swap="outerHTML"
      >
        Edit
      </button>
      {{else if eq .type "string"}}
      <button
        type="submit"
        class="bg-blue-500 p-1 m-2 rounded size-fit text-xs"
        hx-post="/show-phys-page"
        hx-vals='{"type": "hex", "obtained": "true"}'
        hx-target="#modal"
        hx-swap="outerHTML"
      >
        Hex
      </button>
      {{if eq .nx "false"}}
      <button
        type="submit"
        class="bg-blue-500 p-1 m-2 rounded size-fit text-xs"
        hx-post="/show-phys-page"
        hx-vals='{"type": "code"}'
        hx-target="#modal"
        hx-swap="outerHTML"
      >
        Code
      </button>
      {{end}} {{else}}
      <button
        type="submit"
        class="bg-blue-500 p-1 m-2 rounded size-fit text-xs"
        hx-post="/show-phys-page"
        hx-vals='{"type": "hex", "obtained": "true"}'
        hx-target="#modal"
        hx-swap="outerHTML"
      >
        Cancel
      </button>
      <button
        id="saveBtn"
        type="submit"
        class="w-1/3 absolute origin-center bg-blue-500 p-1 mt-2 rounded size-fit text-xs"
        hx-post="/save-phys-page"
        hx-include="[name=phys-page]"
      >
        Save
      </button>
      {{end}}
      <button
        type="submit"
        class="ml-auto top-0 right-0 bg-red-500 p-2 m-1 rounded size-fit"
        hx-post="/close-modal"
        hx-target="#modal"
        hx-swap="outerHTML"
        hx-trigger="click,click from:#saveBtn,click delay:0.5s from:#uploadPage"
      >
        <b>X</b>
      </button>
    </div>
    {{if eq .type "hex"}}
    <div
      class="h-auto w-auto row-start-2 row-end-13 m-2 grid grid-cols-6 rounded content-between space-x-2"
    >
      <div class="col-start-1 col-end-2 rounded pl-3">
        {{range $address := .addresses}}
        <div>0x{{$address}}:</div>
        {{end}}
      </div>
      <div class="col-start-2 col-end-7 bg-red-200 grid grid-cols-2 rounded">
        <div class="col-start-1 col-end-2 bg-yellow-300">
          {{range $bytesChunk1 := .bytes1}}
          <div class="text-center grid grid-cols-8">
            {{range $byte := .}}
            <div class="col-span-1 row-span-1">{{$byte}}</div>
            {{end}}
          </div>
          {{end}}
        </div>
        <div class="col-start-2 col-end-3 bg-green-300">
          {{range $bytesChunk2 := .bytes2}}
          <div class="text-center grid grid-cols-8">
            {{range $byte := .}}
            <div class="col-span-1 row-span-1">{{$byte}}</div>
            {{end}}
          </div>
          {{end}}
        </div>
      </div>
    </div>
    {{else if eq .type "string"}}
    <div
      class="m-2 w-auto break-words whitespace-normal overflow-hidden text-wrap"
    >
      {{.string}}
    </div>
    {{else if eq .type "code"}}
    <div class="m-2 p-3 w-auto break-words whitespace-normal overflow-hidden">
      <pre>{{.code}}</pre>
    </div>
    {{else}}
    <div
      class="h-auto w-auto row-start-2 row-end-13 m-2 grid grid-cols-6 rounded content-between space-x-2"
    >
      <div class="col-start-1 col-end-2 rounded pl-3">
        {{range $address := .addresses}}
        <div>0x{{$address}}:</div>
        {{end}}
      </div>
      <div class="col-start-2 col-end-7 bg-red-200 rounded">
        <textarea
          name="phys-page"
          class="w-full h-full resize-none overflow-hidden pl-3"
          style="
            line-height: 1.429;
            word-spacing: 1rem;
            font-family:
              Courier New,
              monospace;
          "
        >
{{range $byteChunk := .bytes}}{{range $byte := $byteChunk}}{{$byte}} {{end}}{{end}}</textarea
        >
      </div>
      {{end}}
    </div>
  </div>
  {{ end }}
</div>
